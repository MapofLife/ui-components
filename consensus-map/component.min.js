/*! 2015-08-17 */
angular.module("mol-consensus-map-templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("mol-consensus-map-main.html","<leaflet paths=paths markers=markers center=center bounds=extent width={{width}} layers=layers defaults=defaults height={{height}}></leaflet>")}]),angular.module("mol.consensus-map",["mol-consensus-map-templates"]).directive("molConsensusMap",["$http","leafletBoundsHelpers",function($http,leafletBoundsHelpers){return{restrict:"E",scope:{scientificname:"=scientificname",width:"=width",height:"=height",extent:"=extent"},templateUrl:"mol-consensus-map-main.html",controller:function($scope,$http,leafletBoundsHelpers){$scope.defaults={scrollWheelZoom:!1},$scope.center={lat:0,lng:0,zoom:2},$scope.layers={baselayers:{positron:{name:"Positron",type:"xyz",url:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",layerOptions:{subdomains:["a","b","c"],attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',continuousWorld:!1},errorTileUrl:"/app/img/blank_tile.png"}},overlays:{}},$scope.$watch("extent",function(newValue,oldValue){console.log(newValue)}),$scope.$watch("scientificname",function(newValue,oldValue){newValue&&$http({withCredentials:!1,method:"POST",url:"https://mol.cartodb.com/api/v1/map/named/consensus_map",data:{scientificname:newValue}}).then(function(result,status,headers,config){$scope.layers.overlays.consensus={type:"xyz",url:"https://{0}/mol/api/map/{1}/{z}/{x}/{y}.png".format(result.data.cdn_url.https,result.data.layergroupid),layerOptions:{attribution:"Â©2014 Map of Life",continuousWorld:!1},name:"consensus",opacity:.8,refresh:!0,errorTileUrl:"/app/img/blank_tile.png"}})})}}}]);