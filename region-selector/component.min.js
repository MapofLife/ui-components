/*! 2015-09-30 */
angular.module("mol-region-selector-templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("mol-region-selector.html",'<div class=modal-content><div class=modal-header><button type=button ng-click=$close() tabindex=-1 class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button><h4 class=modal-title>Select Region</h4></div><div class=modal-body><div class=row><div class="form-group col-md-6 col-xs-12"><ui-select autofocus ng-model=regionTypes.selected on-select=regionTypeSelected() class=region-selector-control><ui-select-match placeholder="Region type...">{{$select.selected.region_name}}</ui-select-match><ui-select-choices repeat="regionType in regionTypes.available | filter: $select.search"><small ng-bind-html="regionType.region_name | highlight: $select.search | to_trusted"></small></ui-select-choices></ui-select></div><div class="form-group col-md-6 col-xs-12"><ui-select ng-model=regions.selected class=region-selector-control><ui-select-match placeholder=Region...>{{$select.selected.region_name}}</ui-select-match><ui-select-choices repeat="region in regions.available | filter: {region_type: regionTypes.selected.region_type} | filter: $select.search"><small ng-bind-html="region.region_name | highlight: $select.search | to_trusted"></small></ui-select-choices></ui-select></div></div><div class=modal-footer><button type=button class="btn btn-default" tabindex=-1 data-dismiss=modal aria-label=Close ng-click=$close()>Cancel</button> <button type=button ng-click=regionSelected() class="btn btn-primary">Select</button></div></div></div>')}]),angular.module("mol.region-selector",["mol-region-selector-templates"]).filter("to_trusted",["$sce",function($sce){return function(text){return $sce.trustAsHtml(text)}}]).directive("molRegionSelector",["$modal","$http","$cookies",function($modal,$http,$cookies){return{restrict:"A",scope:{location:"@molRegionSelector"},controller:function($scope){$http({url:"http://api-beta.map-of-life.appspot.com//0.x/searchregion",method:"GET",crossDomain:!0,dataType:"json",params:{auth_token:$cookies.get("muprsns")},withCredentials:!1}).then(function(results){var regionType={};$scope.regionTypes=[],$scope.allRegions=results.data,angular.forEach(results.data,function(region){regionType[region.region_type]||(regionType[region.region_type]=1,$scope.regionTypes.push({region_type:region.region_type,region_name:region.region_type.replace("_"," ").replace(/\w\S*/g,function(str){return str.charAt(0).toUpperCase()+str.substr(1).toLowerCase()})}))}),$scope.regionTypes.sort(function(a,b){return+(a.label>b.label)||+(a.label===b.label)-1})})},link:function(scope,element,attrs,ctrl){element.bind("click",function(){$modal.open({animmation:!0,templateUrl:"mol-region-selector.html",controller:function($scope){$scope.regionTypes={selected:{},available:scope.regionTypes},$scope.regions={selected:{},available:scope.allRegions},$scope.regionSelected=function(){console.log($scope.regions.selected)},$scope.regionTypeSelected=function(){console.log($scope.regionTypes.selected)}}})})}}}]),function(){var cssText=".region-selector-control .form-control{width:100%;max-width:100%}",styleEl=document.createElement("style");if(document.getElementsByTagName("head")[0].appendChild(styleEl),styleEl.styleSheet)styleEl.styleSheet.disabled||(styleEl.styleSheet.cssText=cssText);else try{styleEl.innerHTML=cssText}catch(e){styleEl.innerText=cssText}}();