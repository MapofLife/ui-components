/*! 2015-08-06 */
angular.module("mol-taxa-counts-templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("mol-taxa-counts-main.html",'<div ng-show=taxa class="panel panel-default"><div class=panel-heading><h2><i class="fa fa-table red"></i><strong>Species Groups</strong></h2></div><div class="panel-body-table allow-scroll"><table class="table table-bordered table-hover table-responsive"><thead><tr><th></th><th>Group</th><th>Count</th></tr></thead><tbody><tr ng-repeat="taxon in taxa | orderBy:\'+taxa\'" ng-class="{active: (taxon.taxa == selected)}" class=clickable ng-click=selectTaxon(taxon)><td><img ng-src=https://auth.mol.org/static/images/groups/{{taxon.class}}_40.png width=40px></td><td>{{taxon.taxa | capitalize}}</td><td>{{taxon.species.length}}</td></tr></tbody></table></div></div>')}]),angular.module("mol.taxa-counts",["mol-taxa-counts-templates"]).directive("molTaxaCounts",["MOLApi","$state",function(MOLApi,$state){return{restrict:"E",scope:{taxon:"=taxon",location:"=location",lang:"=lang"},templateUrl:"mol-taxa-counts-main.html",controller:function($scope,MOLApi){$state.params.taxa&&($scope.selected=$state.params.taxa),$scope.selectTaxon=function(taxon){var params=$state.params,state=$state.current.name;"location"==state&&(state="location.latlng",params.lat=$scope.location.lat,params.lng=$scope.location.lng),$scope.taxon=taxon,$scope.selected=taxon.taxa,params.taxa=taxon.taxa,$state.transitionTo(state,params)},$scope.$watch("location",function(newValue,oldValue){$scope.taxa=void 0,$scope.taxon=void 0,MOLApi("specieslist",{lat:$scope.location.lat,lng:$scope.location.lng,radius:5e4,lang:"en"}).then(function(result){$scope.taxa=result.data,$scope.selected&&angular.forEach($scope.taxa,function(taxon){taxon.taxa===$scope.selected&&($scope.taxon=taxon)})})},!0)}}}]);